---
title: Golang基础：源码与包
abbrlink: 43491
date: 2021-04-11 17:51:11
tags: golang
categories: 技术
---

#### 为什么要引入“包”的概念？

1. 任何一门设计精良的编程语言，其编写出来的程序必然是可以模块化的。模块化的好处有两个：一是分工明确，分层清晰，容易看懂；二是方便复用，减少重复建设，提高效率。“包”就是Golang用来模块化的工具。Golang中最小的功能单位可以认为是函数，但是如果是特别复杂的功能，一个函数可能难以完成，即使完成了也会非常庞大，可读性不好；所以复杂的功能往往会拆分成几个函数来实现。这几个函数在逻辑上是一体的，不能分开，那么就需要一个容器将他们“盛放”在一起，这个容器就是包。即使不考虑可读性的问题，以函数作为复用的基本单位也是不合理的，一个模块可能会包含几个不同的功能，不能放在同一个函数里面实现，此时仍然需要用“包”将这组函数封装起来。对于只有一个函数的功能模块，是不是就可以不使用“包”了呢？请看第二点。
2. 不同模块之间的函数可能会重名，但是有了包做前缀，就不会相互影响。“包”在这里起到了命名空间的作用，可以隔离同名函数。就像同一个目录下不能出现名字完全一样的文件，但是不同目录下的文件同名却没有问题。当然，同一个包下面，也不允许出现同名的编程元素。

#### Golang“包”的语法

“包”的概念反映到Golang语法中就是关键字“package”，用来声明包的名字；而且还规定每个Golang源代码文件的第一行必须是包声明，否则无法通过编译；Golang的源代码文件是以“.go”为命名后缀的文本文件（不是这个后缀则无法被Golang的编译工具识别）。示例如下：

```shell
➜  cat test.go 
package main

func main() {}
```

语法上，package关键字和包名之间隔了一个空格；包名不可以用双引号包裹。

#### Golang编译工具之go build

Golang提供了一系列的工具，来保证程序的构建和运行，其中最基本的是编译工具“go build”。“go”是一个shell命令，在Golang安装完成后就可以在命令行使用；build是“go”命令的众多功能（或参数）之一，用来编译Golang源代码。

“go build”最基本的用法就是后面直接跟一个源代码文件，如下：

```shell
➜  ls
main.go
➜  go build main.go
```

这是在源代码所在的当前目录中执行的；当然也可以在任意目录中编译，只要给“go build”提供源代码文件在**文件系统中正确的路径**就可以了，不管是相对路径还是绝对路径。

当然，为了提高效率，可以以目录为单位进行编译。此时，指定目录下的所有Golang源码文件都会被编译，不过会有一些限制，见下面所述。

#### Golang的包、源代码文件和目录之间的关系

同一个包的源代码，可以集中在同一个文件中，也可以分散在不同的文件中，只要这些文件第一行声明的是同一个包名。

这些同一个包的文件，要位于文件系统的同一个目录下，而且不包含子目录，否则编译器会认为它们不属于同一个包。

另外，在同一个目录下，要求所有的源代码文件属于同一个包，不允许有不同的包声明，否则以目录为单位进行编译会不通过。

上面所说的目录，其名字可以和包名不一致，但是强烈建议保持一致。

#### Golang源代码的分类

根据用途的不同，Golang源代码分为三类，分别是：命令源码文件、库源码文件和测试源码文件。

#### 特殊的包名：main



#### 环境变量GOROOT、GOPATH

#### Golang源码目录约定

#### import关键字

#### Golang编译工具之go install



#### 















